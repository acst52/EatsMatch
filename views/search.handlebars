<head>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <style>
        fieldset {
            border: 0;
        }

        label {
            display: block;
            margin: 30px 0 0 0;
        }

        .overflow {
            height: 200px;
        }

        .ui-selectmenu-button {
            border-radius: 50px;
            padding: 10px;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <script>
        $(function () {
            // so here we want to init the selectmenu widget to refresh so it generates the dishes/restos dynamically.
            $(function () {
                $.get('/api/restos', function (restos) {
                    const restoOptions = restos.map(resto => `<option value="${resto.id}">${resto.resto_name}</option>`).join('');
                    $("#restoSearch").html(restoOptions).selectmenu('refresh');
                });

                $.get('/api/dishes', function (dishes) {
                    const dishOptions = dishes.map(dish => `<option value="${dish.id}">${dish.dish_name}</option>`).join('');
                    $("#tagSearch").html(dishOptions).selectmenu('refresh');
                });

                $("#restoSearch").selectmenu();
                $("#tagSearch").selectmenu();
            })
        });
    </script>
</head>

<section class="search-bar">

    <h2 id="searchHead">Save money, eat better:</h2>

    <form action="/search" method="get">

        <fieldset>
            <label for="restoSearch">SEARCH BY RESTAURANT</label>
            <select name="restoSearch" id="restoSearch">
                {{!-- POPULATE DROPDOWNS WITH DATA FROM DB: each block to loop thru restos and dishes arrays, creating
                an option element for ea item. value attrib is set to id of resto or dish, displayed test = resto or
                dish name. --}}
                {{#each restos}}
                <option value="{{id}}">{{resto_name}}</option>
                {{/each}}

            </select>



            <label for="tagSearch">SEARCH BY DISH</label>
            <select name="tagSearch" id="tagSearch">
                {{#each dishes}}
                <option value="{{id}}">{{dish_name}}</option>
                {{/each}}
            </select>

        </fieldset>

    </form>
    <button id="test-submit">test submit</button>


    <script>

        let testEl = document.querySelector('#restoSearch');

        let testBtn = document.querySelector('#test-submit').addEventListener('click', (() => {

            console.log(testEl.value);

            let url = `/api/restos/${testEl.value}`;

            console.log(url);

            window.location.replace(url);

        }));


    </script>


</section>

{{!-- need some front-end js for this submit button to fetch the path --}}